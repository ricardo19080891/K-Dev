<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>K-Genda â€¢ Assistente Pessoal</title>

  <!-- PWA -->
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#0ea5e9">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">

  <style>
    body {
      margin: 0;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
      background: #f5f7fb;
      color: #0f172a;
    }
    header {
      background: linear-gradient(135deg, #0ea5e9, #6366f1);
      color: white;
      padding: 16px;
      text-align: center;
      font-size: 20px;
      font-weight: 600;
    }
    main {
      padding: 16px;
    }
    .card {
      background: white;
      border-radius: 14px;
      padding: 16px;
      margin-bottom: 16px;
      box-shadow: 0 10px 25px rgba(0,0,0,.06);
    }
    .fab {
      position: fixed;
      bottom: 24px;
      right: 24px;
      width: 60px;
      height: 60px;
      border-radius: 50%;
      background: linear-gradient(135deg, #6366f1, #0ea5e9);
      color: white;
      border: none;
      font-size: 26px;
      cursor: pointer;
      box-shadow: 0 10px 25px rgba(0,0,0,.25);
    }
  </style>
</head>

<body>

<header>
  K-Genda â€¢ Assistente Pessoal
</header>

<main id="app" hidden>
  <div class="card">
    <h3>Status</h3>
    <p id="status">Inicializandoâ€¦</p>
  </div>

  <div class="card">
    <h3>Ãšltima aÃ§Ã£o</h3>
    <p id="lastAction">Nenhuma</p>
  </div>
</main>

<button class="fab" onclick="startVoice()">ðŸŽ¤</button>

<script>
/* ===========================
   PERFIL / STARTUP LIMPO
=========================== */

function getProfile() {
  return localStorage.getItem("kgenda_active_profile_v2");
}

function createGuestProfile() {
  const profile = {
    id: "guest",
    name: "Visitante",
    created: Date.now()
  };
  localStorage.setItem(
    "kgenda_active_profile_v2",
    JSON.stringify(profile)
  );
  return profile;
}

function startup() {
  let profile = getProfile();

  if (!profile) {
    profile = createGuestProfile();
  } else {
    profile = JSON.parse(profile);
  }

  document.getElementById("app").hidden = false;
  document.getElementById("status").innerText = "App pronto âœ…";
  document.getElementById("lastAction").innerText = "Nenhuma";

  console.log("K-Genda iniciado com perfil:", profile);
}

document.addEventListener("DOMContentLoaded", startup);

/* ===========================
   VOZ (placeholder seguro)
=========================== */

function startVoice() {
  document.getElementById("lastAction").innerText =
    "Microfone ativado (mock)";
}

/* ===========================
   SERVICE WORKER
=========================== */

if ("serviceWorker" in navigator) {
  navigator.serviceWorker.register("service-worker.js");
}
</script>

</body>
</html>
